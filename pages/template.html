---
layout: default
title: temp
permalink: /temp
---

  <!-- Passphrase Input Section -->
  <div id="keyPrompt">
    <label for="encryptionKey">Enter Encryption Key:</label>
    <input type="text" id="encryptionKey" class="form-control half-width" placeholder="Enter the passphrase to decrypt">
    <button type="button" id="decryptBtn" class="btn btn-primary mt-2">Decrypt</button>
  </div>

<div class="container">
  <h1 id="title"></h1>
  <p><strong>Deliver:</strong> <span id="deliver"></span></p>
  <p><strong>Short Summary:</strong> <span id="shortSummary"></span></p>
  <p><strong>Long Summary:</strong></p>
  <p id="longSummary"></p>
  <p><strong>Projects:</strong></p>
  <ul id="projects"></ul>
  <p><strong>Locations:</strong></p>
  <ul id="locations"></ul>
  <p><strong>Special Notes:</strong></p>
  <ul id="specialNotes"></ul>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    const encodedData = params.get('data');
    const decryptBtn = document.getElementById('decryptBtn');
    const encryptionKeyInput = document.getElementById('encryptionKey');
    const workpadContent = document.getElementById('workpadContent');
    const keyPrompt = document.getElementById('keyPrompt');

    decryptBtn.addEventListener('click', function() {
      const encryptionKey = encryptionKeyInput.value;
      if (!encryptionKey) {
        alert('Please enter the encryption key.');
        return;
      }

      if (encodedData) {
        try {
          console.log('Encoded Data:', encodedData); // Debugging log

          // Decode the URL-safe string
          const compressed = Uint8Array.from(atob(decodeURIComponent(encodedData)), c => c.charCodeAt(0));
          console.log('Compressed Data:', compressed); // Debugging log

          // Decompress the data
          const encryptedString = pako.inflate(compressed, { to: 'string' });
          console.log('Encrypted String:', encryptedString); // Debugging log

          // Decrypt the string using the provided encryption key
          const jsonString = encryptedString.split('').map((char, i) =>
            String.fromCharCode(char.charCodeAt(0) ^ encryptionKey.charCodeAt(i % encryptionKey.length))
          ).join('');
          console.log('Decrypted JSON String:', jsonString); // Debugging log

          const data = JSON.parse(jsonString);
          console.log('Parsed Data:', data); // Debugging log

          // Populate the template with decoded data
          document.getElementById('title').textContent = data.title;
          document.getElementById('deliver').textContent = data.deliver;
          document.getElementById('shortSummary').textContent = data.shortSummary;
          document.getElementById('longSummary').textContent = data.longSummary;

          const projectsList = document.getElementById('projects');
          data.projects.forEach(project => {
            const li = document.createElement('li');
            li.textContent = project;
            projectsList.appendChild(li);
          });

          const locationsList = document.getElementById('locations');
          data.locations.forEach(location => {
            const li = document.createElement('li');
            li.textContent = location;
            locationsList.appendChild(li);
          });

          const specialNotesList = document.getElementById('specialNotes');
          data.specialNotes.forEach(note => {
            const li = document.createElement('li');
            li.textContent = note;
            specialNotesList.appendChild(li);
          });

          // Show the workpad content
          keyPrompt.style.display = 'none';
          workpadContent.style.display = 'block';
        } catch (error) {
          console.error('Error decoding or decrypting the data:', error);
          alert('Failed to decode or decrypt the data. Please check the encryption key.');
        }
      } else {
        alert('No data found in the URL.');
      }
    });
  });
</script>