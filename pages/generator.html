---
layout: default
title: new
permalink: /new/
---

<div class="container">
  <h1>New Workpad</h1>
  
  <form id="generatorForm" class="worker-form">
    <div class="form-group">
      <label for="title" class="form-label">Title:</label>
      <input type="text" id="title" class="form-control half-width" required>
    </div>
    
    <div class="form-group">
      <label for="deliver" class="form-label">Deliver:</label>
      <input type="date" id="deliver" class="form-control" required>
    </div>
    
    <div class="form-group">
      <label for="shortSummary" class="form-label">Short Summary:</label>
      <input type="text" id="shortSummary" class="form-control half-width" required>
    </div>
    
    <div class="form-group">
      <label for="longSummary" class="form-label">Long Summary:</label>
      <textarea id="longSummary" class="form-control half-width" rows="5" required></textarea>
    </div>

    <div class="form-group">
      <label for="projects" class="form-label">Projects:</label>
      <input type="text" id="projectsInput" class="form-control half-width">
      <button type="button" id="addProjectBtn" class="btn btn-secondary mt-2">Add Project</button>
      <ul id="projectsList" class="list-group mt-2"></ul>
    </div>

    <div class="form-group">
      <label for="locations" class="form-label">Locations:</label>
      <input type="text" id="locationsInput" class="form-control half-width">
      <button type="button" id="addLocationBtn" class="btn btn-secondary mt-2">Add Location</button>
      <ul id="locationsList" class="list-group mt-2"></ul>
    </div>

    <div class="form-group">
      <label for="specialNotes" class="form-label">Special Notes:</label>
      <input type="text" id="specialNotesInput" class="form-control half-width">
      <button type="button" id="addSpecialNoteBtn" class="btn btn-secondary mt-2">Add Note</button>
      <ul id="specialNotesList" class="list-group mt-2"></ul>
    </div>

    <div class="form-group">
      <label for="encryptionKey" class="form-label">Encryption Key:</label>
      <input type="text" id="encryptionKey" class="form-control half-width" placeholder="Enter a simple key (e.g., Car)" required>
    </div>
    
    <button type="button" id="generateBtn" class="btn btn-primary">Generate Link</button>
  </form>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generateBtn');
    generateBtn.addEventListener('click', function() {
      const title = document.getElementById('title').value;
      const deliver = document.getElementById('deliver').value;
      const shortSummary = document.getElementById('shortSummary').value;
      const longSummary = document.getElementById('longSummary').value;
      const encryptionKey = document.getElementById('encryptionKey').value;

      const projects = Array.from(document.getElementById('projectsList').children).map(li => li.textContent);
      const locations = Array.from(document.getElementById('locationsList').children).map(li => li.textContent);
      const specialNotes = Array.from(document.getElementById('specialNotesList').children).map(li => li.textContent);

      if (!title || !deliver || !shortSummary || !longSummary || !encryptionKey) {
        alert('Please fill in all required fields');
        return;
      }

      const data = {
        title,
        deliver,
        shortSummary,
        longSummary,
        projects,
        locations,
        specialNotes
      };

      try {
        // Convert data to JSON string
        const jsonString = JSON.stringify(data);

        // Encrypt the JSON string using a simple XOR cipher with the encryption key
        const encryptedData = jsonString.split('').map((char, i) =>
          String.fromCharCode(char.charCodeAt(0) ^ encryptionKey.charCodeAt(i % encryptionKey.length))
        ).join('');

        // Compress the encrypted string
        const compressed = pako.deflate(encryptedData);

        // Convert compressed binary data to base64
        const base64String = btoa(String.fromCharCode.apply(null, compressed));

        // Encode the base64 string to make it URL-safe
        const urlSafeString = encodeURIComponent(base64String);

        // Generate the URL
        const link = `https://workpads.app/temp.html?data=${urlSafeString}`;
        alert(`Generated Link: ${link}`);
      } catch (error) {
        console.error('Error generating the link:', error);
        alert('Failed to generate the link. Please try again.');
      }
    });
  });
</script>